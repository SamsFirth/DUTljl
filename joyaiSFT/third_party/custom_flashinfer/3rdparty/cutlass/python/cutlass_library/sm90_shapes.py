"""
Valid WGMMA shapes, MMA multipliers, and cluster sizes for SM90, associated with levels.
These shape and level pairs are defined as dicts, where keys are shapes and values are their
associated levels. If the user input level for that category (MMA multiplier, WGMMA shape, cluster
size) is smaller than a shape's associated level, it will be excluded, and otherwise, included.
Higher levels are therefore less likely emitted, but lower levels are more emitted more frequently.
Level 0 is always emitted. The default behavior in `generator.py` is that level 1 is only emitted
when the `--kernel` argument is non-empty.
"""
SM90_MMA_MULTIPLIERS = {(2, 1, 4): 0, (1, 1, 4): 1, (4, 1, 4): 2, (2, 2, 4): 3, (2, 1, 8): 4, (4, 1, 8): 4, (1, 1, 8): 4, (2, 2, 8): 4, (2, 1, 16): 5, (4, 1, 16): 5, (1, 1, 16): 5, (2, 2, 16): 5}
SM90_CLUSTER_SIZES = {(1, 2, 1): 0, (2, 1, 1): 1, (1, 1, 1): 2, (2, 2, 1): 3, (1, 4, 1): 3, (4, 1, 1): 3, (2, 4, 1): 4, (4, 2, 1): 4, (1, 8, 1): 4, (8, 1, 1): 4, (4, 4, 1): 5}
SM90_WGMMA_SHAPES_FP16_BF16_DENSE = {(64, 8, 16): 2, (64, 16, 16): 2, (64, 24, 16): 3, (64, 32, 16): 2, (64, 40, 16): 3, (64, 48, 16): 3, (64, 56, 16): 3, (64, 64, 16): 2, (64, 72, 16): 3, (64, 80, 16): 3, (64, 88, 16): 3, (64, 96, 16): 3, (64, 104, 16): 3, (64, 112, 16): 3, (64, 120, 16): 3, (64, 128, 16): 0, (64, 136, 16): 3, (64, 144, 16): 3, (64, 152, 16): 3, (64, 160, 16): 3, (64, 168, 16): 3, (64, 176, 16): 3, (64, 184, 16): 3, (64, 192, 16): 3, (64, 200, 16): 3, (64, 208, 16): 3, (64, 216, 16): 3, (64, 224, 16): 3, (64, 232, 16): 3, (64, 240, 16): 3, (64, 248, 16): 3, (64, 256, 16): 1}
SM90_WGMMA_SHAPES_TF32_DENSE = {(64, 8, 8): 2, (64, 16, 8): 2, (64, 24, 8): 3, (64, 32, 8): 2, (64, 40, 8): 3, (64, 48, 8): 3, (64, 56, 8): 3, (64, 64, 8): 2, (64, 72, 8): 3, (64, 80, 8): 3, (64, 88, 8): 3, (64, 96, 8): 3, (64, 104, 8): 3, (64, 112, 8): 3, (64, 120, 8): 3, (64, 128, 8): 0, (64, 136, 8): 3, (64, 144, 8): 3, (64, 152, 8): 3, (64, 160, 8): 3, (64, 168, 8): 3, (64, 176, 8): 3, (64, 184, 8): 3, (64, 192, 8): 3, (64, 200, 8): 3, (64, 208, 8): 3, (64, 216, 8): 3, (64, 224, 8): 3, (64, 232, 8): 3, (64, 240, 8): 3, (64, 248, 8): 3, (64, 256, 8): 1}
SM90_WGMMA_SHAPES_FP8_DENSE = {(64, 8, 32): 2, (64, 16, 32): 2, (64, 24, 32): 3, (64, 32, 32): 2, (64, 40, 32): 3, (64, 48, 32): 3, (64, 56, 32): 3, (64, 64, 32): 2, (64, 72, 32): 3, (64, 80, 32): 3, (64, 88, 32): 3, (64, 96, 32): 3, (64, 104, 32): 3, (64, 112, 32): 3, (64, 120, 32): 3, (64, 128, 32): 0, (64, 136, 32): 3, (64, 144, 32): 3, (64, 152, 32): 3, (64, 160, 32): 3, (64, 168, 32): 3, (64, 176, 32): 3, (64, 184, 32): 3, (64, 192, 32): 3, (64, 200, 32): 3, (64, 208, 32): 3, (64, 216, 32): 3, (64, 224, 32): 3, (64, 232, 32): 3, (64, 240, 32): 3, (64, 248, 32): 3, (64, 256, 32): 1}
SM90_WGMMA_SHAPES_INT8_DENSE = {(64, 8, 32): 2, (64, 16, 32): 2, (64, 24, 32): 3, (64, 32, 32): 2, (64, 48, 32): 3, (64, 64, 32): 2, (64, 80, 32): 3, (64, 96, 32): 3, (64, 112, 32): 3, (64, 128, 32): 0, (64, 144, 32): 3, (64, 160, 32): 3, (64, 176, 32): 3, (64, 192, 32): 3, (64, 208, 32): 3, (64, 224, 32): 3, (64, 240, 32): 3, (64, 256, 32): 1}